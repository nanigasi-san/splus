\documentclass[11pt,a4j]{jarticle}
\setcounter{secnumdepth}{6}
\setlength{\headheight}{16pt}
\usepackage{datetime2}
\usepackage{comment}
\usepackage{float}
\usepackage{color}
\usepackage{multicol}
\usepackage[dvipdfmx]{pict2e}
\usepackage{wrapfig}
\usepackage{graphicx}
\usepackage{bm}
\usepackage{url}
\usepackage{underscore}
\usepackage{colortbl}
\usepackage{tabularx}
\usepackage{fancyhdr}
\usepackage{ulem}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage[ipaex]{pxchfon}
\usepackage[top=30truemm,bottom=30truemm,left=25truemm,right=25truemm]{geometry}
\usepackage[dvipdfmx, hidelinks]{hyperref}
\usepackage{pxjahyper}

%macro
\newcommand{\splus}{S${}^\text{+}$}
\newcommand{\riplus}{RI${}^\text{+}$}
\newcommand{\f}[1]{$\rm{#1}$} %flat math
\newcommand{\image}[4][height=100pt]{%
\begin{figure}[htbp]
    \centering
    \includegraphics[width=200pt, #1]{../../docs/images/#2}
    \caption{#3}
    \label{fig:#4}
\end{figure}%
}

\newcommand{\ra }{$\rightarrow$}
\newcommand{\tops}[2]{\texorpdfstring{#1}{#2}} %tex or pdf strings
%macro

%title
\title{KEG上におけるクロスキャップ数の計算}
\author{Kaito Yamada}
\date{\today}

\begin{document}
\maketitle
\vspace{30mm}
\begin{abstract}
    クロスキャップ数の計算効率化(仮)
\end{abstract}

\clearpage
%=====================================================================================

% 目次の表示
\tableofcontents
\clearpage

%=====================================================================================
\pagestyle{plain}
\lhead{\rightmark}

%1章==============================================================
\section{はじめに}

\subsection{研究背景}
\subsubsection{\tops{\splus}{splus} とは}
\subsubsection{KEGとは}
前論文\cite{keg}で結び目をオイラーグラフとして解釈し、Knot Eulerian Graph(KEG)のデータ構造を提案した。今回のアルゴリズムはKEGに対して定義されているが、データ構造の細部について、より適切な変更と命名を施しておく。

まず、視覚的な判別性の向上のため、図\ref{fig:parity}に示すように奇数交点の頂点を円、偶数交点の頂点を正方形で表すこととした。
\image{about_parity.jpg}{頂点の偶奇}{parity}

そして、図\ref{fig:pole}のように、頂点を軸で区切った際の左右を\textbf{極(pole)}と呼ぶこととする。極は順序を気にせずA/Bと命名され、頂点Xの極は\f{P_X}と表す。この時\f{P_X=A}あるいは\f{P_X=B}である。また、空頂点の極はN(None)とする。
\image[height=200pt]{about_pole.jpg}{頂点の極}{pole}

また、頂点に出入りする辺の向きについて、図\ref{fig:axis}に示す2パターンをそれぞれ\textbf{軸対称(axial symmetry)}、\textbf{非軸対称(asymmtry)}とする。
\image{about_axis.jpg}{軸対称と非軸対称}{axis}

\subsection{先行研究}
\subsubsection{\tops{\f{C(K)=3}}{C(K)=3}の場合}
\f{C(K)=3}の場合については、伊藤昇先生の論文\cite{ck3}にて完全なリストが作成されている。ここでは結び目に対して手作業で網羅的に\splus を施し、生成された結果のうち、結び目として同値なものを削除している。

\subsubsection{KEGの同値判定}

\subsection{研究目的}

%2章======================================================================
\section{アルゴリズムと計算量}

\subsection{グラフの拡張}
グラフを拡張して、\splus の対象となりうる辺がすべて出てくるようにする。グラフを満足に"ほぐす"には、以下の2操作が必要となる。
\begin{itemize}
    \item 頂点の分割
    \item \riplus
\end{itemize}

ここでは例として、図\ref{fig:default}のstep1の結び目を拡張していく。
\image{extend_default.jpg}{step1(拡張前)}{default}

\subsubsection{頂点の分割のアルゴリズム}
頂点内の領域に対して\splus を適用するため、一つの頂点を明示的に分割し、間を繋ぐ2辺を追加する。繋ぐ辺の向きは二種類存在する(軸に対して垂直/平行)

頂点は、それぞれ以下のように分割できる。分割した状態を図\ref{fig:split}に示す。
\begin{itemize}
    \item Odd \ra  Odd + Even / Even + Odd
    \item Even \ra  Odd + Odd / Even + Even
\end{itemize}

\image{extend_split.jpg}{step1(分割)}{split}

\subsubsection{\tops{\riplus}{RI+} のアルゴリズム}
解消できる自己ループを持つOddを追加することで、\riplus を表現する。

(u, v, \f{P_u}, \f{P_v})という辺があるとき、その辺を削除し、Odd頂点Oを追加し、辺(u, O, \f{P_u}, A), (O, O, B, A), (O, v, B, \f{T_v})という辺を追加する。\riplus をした状態を図\ref{fig:riplus}に示す。

\image{extend_riplus.jpg}{step1(\riplus )}{riplus}

どちらの操作も施すと図\ref{fig:total}のようになる。この時、頂点の分割は頂点に対する操作、\riplus は辺に対する操作であることから、頂点の分割\ra \riplus の順で行う必要がある。
\image{extend_total.jpg}{step1(分割+\riplus )}{total}

\subsubsection{計算量}
頂点の分割は、ある分割の仕方(O-OE, O-OO縛り)で、頂点を2つに分割すると、辺の削除が4回、辺の追加が6回発生する。V個の頂点すべてに分割を施すので、$O(V)$\\
愚直にやると、それぞれ2通りの分割の仕方があるため、$2^V$通りのグラフが発生しうる。これは\splus の際に補正を加えることで、E通りに抑えることができる可能性がある。

\riplus では、ある辺について、頂点追加が1回、辺の削除が1回、辺の追加が3回発生する。頂点の分割で頂点数が倍になっているので、2V頂点に対して定数操作を行うため、$O(V)$

全体で$O(V)$あるいは$O(2^V)$

\subsection{\tops{\splus}{S+} の対象の列挙}
\label{enum}
\subsubsection{列挙のアルゴリズム}
\splus はグラフへの操作だが、本質的にはオイラー閉路のうち二辺に対する操作である。あるグラフGが与えられたとき、Gに対応するオイラー閉路(辺のリスト)が一つに定まるが、その閉路の中で\splus の対象となりうる辺のペアは複数現れる。よってそのペア(操作対象)を列挙することが必要である。各ペアの列挙は、以下の操作で実現される。

\begin{enumerate}
    \item グラフGのオイラー閉路\f{C_e}を求める。\f{C_e}の長さはグラフの辺の総数と等しいので、E。
    \item \f{C_e}を2個連結する。
    \item i=[0, E-1]をループし、\f{e_s}=\f{C_e}[i]とする。j=[1, E-1]とし、\f{e_g}=\f{C_e}[i+j]とする。
\end{enumerate}

結果として生成されるペアはE(E-1)組となる。

\subsubsection{計算量}
\begin{enumerate}
    \item オイラー閉路の取得\ra DFSなので$O(E+V)$
    \item オイラー閉路の連結\ra 長さEのものを結合するので$O(E)$
    \item ペアの列挙\ra 各辺を\f{e_s}として、\f{e_g}の候補がE-1通りなので$O(E^2)$
\end{enumerate}
$E=2V \Rightarrow E+V=E+\frac{1}{2}E=\frac{3}{2}E$であるため、$O(E+V)=O(E)$とみなせる。

\subsection{\tops{\splus}{S+} の適用}

\subsubsection{KEGにおける\tops{\splus}{S+} のアルゴリズム}
KEGを対象とした\splus のアルゴリズムはいかに示す通りである。
\begin{enumerate}
    \item Odd頂点Oを追加する。
    \item a, bからOに、Oからc, dに繋がるように辺を追加する。この時aとd, bとcがそれぞれOの同じ側(A/B)に繋がるようにする。即ち、(a, O, \f{P_a}, A), (b, O, \f{P_b}, B), (O, c, B, \f{P_c}), (O, d, A, \f{P_d})の4辺を追加する。
    \item \f{C_e}で\f{e_s} と\f{e_g} の間にある辺全てを逆向きにした辺を追加する。即ち、(u, v, \f{P_u}, \f{P_v})を(v, u, \f{P_v}, \f{P_u})にする。
    \item $[\rm{e_s}, \rm{e_g}]$の辺を削除する
\end{enumerate}

\subsubsection{操作例}
ここでは単純な例を二つ上げ、他の例については付録にて示す。

\paragraph{step0 \ra  step1の例}

\image{step0.jpg}{step0}{step0}

\text{[(0, 1, N, N), (1, 0, N, N)]}\\

区間$[0, 1]$を対象に\splus を行う。\\
\begin{enumerate}
    \item Odd頂点2を追加。
    \item a=0, \f{P_a}=N, b=1, \f{P_b}=N, c=1, \f{P_c}=N, d=0, \f{P_d}=Nとして、頂点2と繋がる辺を追加。(0, 2, N, A),(1, 2, N, B),(2, 1, B, N),(2, 0, A, N)の4辺。
    \item (0, 1, N, N), (1, 0, N, N)を消去。
\end{enumerate}

最終的に残る辺は[(0, 2, N, A),(1, 2, N, B),(2, 1, B, N),(2, 0, A, N)]の4辺。\\

\image{step1.jpg}{step1}{step1}

\paragraph{step1 \ra  step2-2の例}

初めに、step1に\riplus を行い、Odd頂点3が追加された図\ref{fig:step1riplus}の状態にする。

\image{step1_riplus.jpg}{step1(\riplus )}{step1riplus}

[(1, 2, N, B), (2, 0, A, N), (0, 3, N, A), (3, 3, B, A), (3, 2, B, A), (2, 1, B, N)]\\
区間$[0, 3]$を対象に\splus を行う。\\

\begin{enumerate}
    \item Odd頂点4を追加
    \item a=1, \f{P_a}=N, b=2, \f{P_b}=B, c=3, \f{P_c}=B, d=3, \f{P_d}=Aとして、頂点3と繋がる4辺を追加。(1, 4, N, A), (2, 4, B, B), (4, 3, B, B), (4, 3, A, A)の4辺。
    \item (1, 2, N, B), (3, 3, B, A)を消去。
    \item (2, 0, A, N), (0, 3, N, A)を反転して(0, 2, N, A), (3, 0, A, N)にする。
\end{enumerate}

[(3, 2, B, A), (2, 1, B, N), (1, 4, N, A), (2, 4, B, B), (4, 3, B, B), (4, 3, A, A), (0, 2, N, A), (3, 0, A, N)]\\
頂点3, 4はOdd+Odd\ra  Evenに統合でき、統合結果のEven頂点5の追加と空頂点の削除をすると図\ref{fig:step2-2}の通りになる。\\
\text{[(2, 5, B, B), (5, 2, B, A), (2, 5, B, A), (5, 2, A, A)]}\\

\image{step2_2.jpg}{step2-2}{step2-2}

\subsubsection{計算量}
あるKEGにおいて、任意の2辺に対する\splus の結果を得るのに必要な計算量を考えていく。

\begin{enumerate}
    \item 頂点追加\ra  $O(1)$
    \item Odd頂点への4辺の追加\ra 定数なので$O(1)$
    \item \f{e_s}と\f{e_g}の間の辺を逆にする\ra 最大E-2辺に行われるので$O(E)$
    \item 逆転前の辺を削除する\ra 最大E-2辺に行われるので$O(E)$
\end{enumerate}

\ref{enum}節で列挙したペアのそれぞれについて\splus を適用するため、各計算ステップの最大次数を見ると\f{E^2}回のループで$O(E)$の操作をするためトータルで$O(E^3)$

%3章======================================================================
\section{まとめ}
研究のまとめ。なんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんやなんやかんや

%=====================================================================================
\section*{謝辞} %章を付けずにタイトル表示
\addcontentsline{toc}{section}{謝辞} %章立てせずに目次に追加するおまじない
本論文を作成するにあたり、---- みなさまに感謝の意を表します．

%=====================================================================================

\bibliographystyle{plain} %本文に\cite{}を入れることで，参考文献表示
\bibliography{paper.bib} %bibtexファイルの読み込み
\end{document}
